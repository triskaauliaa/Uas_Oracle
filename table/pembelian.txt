CREATE TABLE  "T_PEMBELIAN" 
   (	"KD_TRANSAKSI" NUMBER(5,0), 
	"KD_SUPPLIER" NUMBER(5,0), 
	"KD_BARANG" NUMBER(5,0), 
	"TGL" DATE, 
	"JML" NUMBER(7,0), 
	"HARGA" FLOAT(2), 
	 CONSTRAINT "TB_PEMBELIAN_PK" PRIMARY KEY ("KD_TRANSAKSI") ENABLE
   )
/
ALTER TABLE  "T_PEMBELIAN" ADD CONSTRAINT "TB_PEMBELIAN_FK" FOREIGN KEY ("KD_SUPPLIER")
	  REFERENCES  "T_SUPPLIER" ("ID_SUPPLIER") ENABLE
/
ALTER TABLE  "T_PEMBELIAN" ADD CONSTRAINT "TB_PEMBELIAN_FK2" FOREIGN KEY ("KD_BARANG")
	  REFERENCES  "T_BARANG" ("KD_BARANG") ENABLE
/


CREATE OR REPLACE TRIGGER  "BI_TB_PEMBELIAN" 
  before insert on "T_PEMBELIAN"               
  for each row  
begin   
  if :NEW."KD_PEMBELIAN" is null then 
    select "TB_PEMBELIAN_SEQ".nextval into :NEW."KD_PEMBELIAN" from sys.dual; 
  end if; 
end; 

/
ALTER TRIGGER  "BI_TB_PEMBELIAN" ENABLE
/


CREATE OR REPLACE TRIGGER  "T_PEMBELIAN_UPDATE" 
BEFORE
insert or update or delete on "T_PEMBELIAN"
for each row
 WHEN ((NEW.ID_BARANG > 0)) BEGIN   
   UPDATE t_barang
   SET jml = new.jml
   WHERE id_barang = new.id_barang;
END;
/
ALTER TRIGGER  "T_PEMBELIAN_UPDATE" ENABLE
/


ss